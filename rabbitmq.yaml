  - name: "setup rabbitmq server"
    hosts: rabbitmq
    become: yes
    tasks:
      - name: "copying rabbitmq repo"
        ansible.builtin.copy:
         src: rabbitmq.repo
         dest: /etc/yum.repos.d/rabbitmq.repo
      - name: "install rabbitmq"
        ansible.builtin.package:
          name: rabbitmq-server
          state: present
      - name: "start and enable rabbitmq"
        ansible.builtin.service:
          name: rabbitmq-server
          state: started
          enabled: yes

      - name: "add user and give permissions"
        community.rabbitmq.rabbitmq_user:
           user: roboshop
           password: roboshop123
           permissions:
              - vhost: /
                configure_priv: .*
                read_priv: .*
                write_priv: .*
           state: present

      
       